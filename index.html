<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>WebXR 2D Stream Test</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      -webkit-user-select: none;
      user-select: none;
      touch-action: manipulation;
    }
    video {
      max-width: 100vw;
      max-height: 100vh;
      background: #000;
      outline: none;
    }
    /* Always-on-top Start button so Oculus taps don't get eaten by the video */
    #start {
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translateX(-50%);
      z-index: 99999;
      background: #1e90ff;
      color: #fff;
      border: 0;
      padding: 12px 18px;
      border-radius: 10px;
      font-size: 16px;
      line-height: 1;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    }
  </style>
</head>
<body>

  <video id="video" playsinline webkit-playsinline></video>
  <button id="start" type="button">Tap to start</button>

  <!-- hls.js -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    const video = document.getElementById('video');
    const btn   = document.getElementById('start');

    // >>> Replace this with your HLS .m3u8 URL
    const STREAM_URL = 'https://aps11.playlist.ttvnw.net/v1/playlist/CrsGVq6QSVfOU8qb2VXhx1BtDVMLUjDLu33m99cN_h0xjh1RHpC6mk50j-fMqPy_-vaPqfnSk2F_l5cXbAeZQPKCcT3gk4rHW2pLuusInXMOvPtS9ujKWRFLB4mm1h6_aN5H70hznBYlV2PEDuyMsSeDcoysWbCqBI1cI832I6f1oonv_iXPM094GFw4ZIEQk1Tffs3kR3VZSIL1yQ3f3wNKX5DPapoLcXYREQ7P_vbk-p2xZf_iYxdG2cJDrMx1EEfnBpfoYuqAgCBwRdzeDFDvjPPEV5L_1gryYHj2kkNqmy5PDK0K2Tp7bFsD1jm85dCry-IXASBNVlSKkImDOqyu8yCjOti-G7Pvpf32P5hetNazkj0ZWFzKINtdYlzdtqa5pKyT0COdrIJlS6n9y1cxl8mv2LrkH4_m-iwFkVbhpAd_o6G_357J1kDiNOrWzSHdu8SxVXiD4UsUaSnnoK51zBabAiO57afKFFxSpjsTv-iTwehGZ5WR1d8dkUTdrdPPZhNXoXCkeDC7_Hl7myv6fZ6yz05XtgLzQPkA-Mus6qYQEr1KEpubLGQr3YfXMh-xwTe_URtRlaks0eF3eYC5irkm6XHatzH9kJ1CMMv3moDW8zzEuEGat9JbN9EAlOnBa3NsZXxtRHzLBHCgC-K64-fwGs44DAP_T_-ZGQxX3oFLQd3hV1KSksEcdr9GFrT36xelmU955IFq2Mx2MWMyZHNlYP_P2j7uCHT6V9LKxoyWYZYTVosezMrPzhwTYaOBEZLm15tCS8VEBqWj4hVHo3gE53TXUSzSow8cFity_fhYOQUvYbO1jhEBUmEqBBP4pvck7NRgfttmwclpcOWanF6NNYE1BvLcL4UJxVAq6CYAF3SDjLKH_Aril1paOQywPV2pMRKTr7-8EtfoJ69ak6FXMvwq4Fz3_tb3vLYu5cyR6HIG-n9maRC42uMWmoZ4B7okhkA7V9MiMUG-1tQO7JAUT88O--bxkMibirSb06RzZcwHbNfdazhfGDh4awqjR1kD3CKJi3YsTtzJLWbP4K_P0ZgOUoGHJhhIiGjHDHYy6Ej9cTIYVX5LHitkbKEsiBQLY_bMaMmDT2YaDE_Xh22RzinfOAjWuSABKglldS13ZXN0LTIw-Qw.m3u8';
    // <<<

    function loadAndPlay() {
      btn.style.display = 'none';

      // Remove controls until playback starts (controls overlays can block clicks in VR)
      video.removeAttribute('controls');

      if (window.Hls && Hls.isSupported()) {
        const hls = new Hls({ lowLatencyMode: true });
        hls.loadSource(STREAM_URL);
        hls.attachMedia(video);

        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          video.play().catch(err => {
            console.warn('Autoplay blocked, showing button again:', err);
            btn.style.display = 'block';
          });
        });

        hls.on(Hls.Events.ERROR, (event, data) => {
          console.error('HLS error:', data);
        });
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        // Safari path
        video.src = STREAM_URL;
        video.play().catch(err => {
          console.warn('Autoplay blocked (Safari):', err);
          btn.style.display = 'block';
        });
      } else {
        alert('This browser does not support HLS playback.');
        btn.style.display = 'block';
        return;
      }

      // Add controls after playback begins
      video.addEventListener('playing', () => {
        video.setAttribute('controls', '');
      }, { once: true });
    }

    // Pointer is more reliable in Oculus; keep click as fallback
    btn.addEventListener('pointerdown', loadAndPlay, { passive: true });
    btn.addEventListener('click', loadAndPlay, { passive: true });

    // Resume if page regains focus
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden && video.paused && btn.style.display === 'none') {
        video.play().catch(()=>{});
      }
    });
  </script>
</body>
</html>